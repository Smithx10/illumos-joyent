/*
 * CDDL HEADER START
 *
 * The contents of this file are subject to the terms of the
 * Common Development and Distribution License (the "License").
 * You may not use this file except in compliance with the License.
 *
 * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
 * or http://www.opensolaris.org/os/licensing.
 * See the License for the specific language governing permissions
 * and limitations under the License.
 *
 * When distributing Covered Code, include this CDDL HEADER in each
 * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
 * If applicable, add the following below this CDDL HEADER, with the
 * fields enclosed by brackets "[]" replaced with your own identifying
 * information: Portions Copyright [yyyy] [name of copyright owner]
 *
 * CDDL HEADER END
 */
/*
 * Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
 * Use is subject to license terms.
 */
/*
 * Copyright (c) 2013 Joyent, Inc.  All rights reserved.
 */

#include <sys/types.h>
#include "reloc.h"

/*
 * Several of these codes are Obsolete and Deprecated per ARM. However, we opt
 * not to include those here at this time.
 */
static const char *rels[R_AARCH64_NUM] = {
	[R_AARCH64_NONE] =				"R_AARCH64_NONE",
	[R_AARCH64_NONE_ALT] =				"R_AARCH64_NONE_ALT",
	[R_AARCH64_ABS64] =				"R_AARCH64_ABS64",
	[R_AARCH64_ABS32] =				"R_AARCH64_ABS32",
	[R_AARCH64_ABS16] =				"R_AARCH64_ABS16",
	[R_AARCH64_PREL64] =				"R_AARCH64_PREL64",
	[R_AARCH64_PREL32] =				"R_AARCH64_PREL32",
	[R_AARCH64_PREL16] =				"R_AARCH64_PREL16",
	[R_AARCH64_MOVW_UABS_G0] =			"R_AARCH64_MOVW_UABS_G0",
	[R_AARCH64_MOVW_UABS_G0_NC] =			"R_AARCH64_MOVW_UABS_G0_NC",
	[R_AARCH64_MOVW_UABS_G1] =			"R_AARCH64_MOVW_UABS_G1",
	[R_AARCH64_MOVW_UABS_G1_NC] =			"R_AARCH64_MOVW_UABS_G1_NC",
	[R_AARCH64_MOVW_UABS_G2] =			"R_AARCH64_MOVW_UABS_G2",
	[R_AARCH64_MOVW_UABS_G2_NC] =			"R_AARCH64_MOVW_UABS_G2_NC",
	[R_AARCH64_MOVW_UABS_G3] =			"R_AARCH64_MOVW_UABS_G3",
	[R_AARCH64_MOVW_SABS_G0] =			"R_AARCH64_MOVW_SABS_G0",
	[R_AARCH64_MOVW_SABS_G1] =			"R_AARCH64_MOVW_SABS_G1",
	[R_AARCH64_MOVW_SABS_G2] =			"R_AARCH64_MOVW_SABS_G2",
	[R_AARCH64_LD_PREL_LO19] =			"R_AARCH64_LD_PREL_LO19",
	[R_AARCH64_ADR_PREL_LO21] =			"R_AARCH64_ADR_PREL_LO21",
	[R_AARCH64_ADR_PREL_PG_HI21] =			"R_AARCH64_ADR_PREL_PG_HI21",
	[R_AARCH64_ADR_PREL_PG_HI21_NC] =		"R_AARCH64_ADR_PREL_PG_HI21_NC",
	[R_AARCH64_ADD_ABS_LO12_NC] =			"R_AARCH64_ADD_ABS_LO12_NC",
	[R_AARCH64_LDST8_ABS_LO12_NC] =			"R_AARCH64_LDST8_ABS_LO12_NC",
	[R_AARCH64_LDST16_ABS_LO12_NC] =		"R_AARCH64_LDST16_ABS_LO12_NC",
	[R_AARCH64_LDST32_ABS_LO12_NC] =		"R_AARCH64_LDST32_ABS_LO12_NC",
	[R_AARCH64_LDST64_ABS_LO12_NC] =		"R_AARCH64_LDST64_ABS_LO12_NC",
	[R_AARCH64_LDST128_ABS_LO12_NC] =		"R_AARCH64_LDST128_ABS_LO12_NC",
	[R_AARCH64_TSTBR14] =				"R_AARCH64_TSTBR14",
	[R_AARCH64_CONDBR19] =				"R_AARCH64_CONDBR19",
	[R_AARCH64_JUMP26] =				"R_AARCH64_JUMP26",
	[R_AARCH64_CALL26] =				"R_AARCH64_CALL26",
	[R_AARCH64_MOVW_PREL_G0] =			"R_AARCH64_MOVW_PREL_G0",
	[R_AARCH64_MOVW_PREL_G0_NC] =			"R_AARCH64_MOVW_PREL_G0_NC",
	[R_AARCH64_MOVW_PREL_G1] =			"R_AARCH64_MOVW_PREL_G1",
	[R_AARCH64_MOVW_PREL_G1_NC] =			"R_AARCH64_MOVW_PREL_G1_NC",
	[R_AARCH64_MOVW_PREL_G2] =			"R_AARCH64_MOVW_PREL_G2",
	[R_AARCH64_MOVW_PREL_G2_NC] =			"R_AARCH64_MOVW_PREL_G2_NC",
	[R_AARCH64_MOVW_PREL_G3] =			"R_AARCH64_MOVW_PREL_G3",
	[R_AARCH64_MOVW_GOTOFF_G0] =			"R_AARCH64_MOVW_GOTOFF_G0",
	[R_AARCH64_MOVW_GOTOFF_G0_NC] =			"R_AARCH64_MOVW_GOTOFF_G0_NC",
	[R_AARCH64_MOVW_GOTOFF_G1] =			"R_AARCH64_MOVW_GOTOFF_G1",
	[R_AARCH64_MOVW_GOTOFF_G1_NC] =			"R_AARCH64_MOVW_GOTOFF_G1_NC",
	[R_AARCH64_MOVW_GOTOFF_G2] =			"R_AARCH64_MOVW_GOTOFF_G2",
	[R_AARCH64_MOVW_GOTOFF_G2_NC] =			"R_AARCH64_MOVW_GOTOFF_G2_NC",
	[R_AARCH64_MOVW_GOTOFF_G3] =			"R_AARCH64_MOVW_GOTOFF_G3",
	[R_AARCH64_MOVW_GOTREL64] =			"R_AARCH64_MOVW_GOTREL64",
	[R_AARCH64_MOVW_GOTREL32] =			"R_AARCH64_MOVW_GOTREL32",
	[R_AARCH64_GOT_LD_PREL19] =			"R_AARCH64_GOT_LD_PREL19",
	[R_AARCH64_LD64_GOTOFF_LO15] =			"R_AARCH64_LD64_GOTOFF_LO15",
	[R_AARCH64_ADR_GOT_PAGE] =			"R_AARCH64_ADR_GOT_PAGE",
	[R_AARCH64_LD64_GOT_LO12_NC] =			"R_AARCH64_LD64_GOT_LO12_NC",
	[R_AARCH64_LD64_GOTPAGE_LO15] =			"R_AARCH64_LD64_GOTPAGE_LO15",
	[R_AARCH64_TLSGD_ADR_PREL21] =			"R_AARCH64_TLSGD_ADR_PREL21",
	[R_AARCH64_TLSGD_ADR_PAGE21] =			"R_AARCH64_TLSGD_ADR_PAGE21",
	[R_AARCH64_TLSGD_ADD_LO12_NC] =			"R_AARCH64_TLSGD_ADD_LO12_NC",
	[R_AARCH64_TLSGD_MOVW_G1] =			"R_AARCH64_TLSGD_MOVW_G1",
	[R_AARCH64_TLSGD_MOVW_G0_NC] =			"R_AARCH64_TLSGD_MOVW_G0_NC",
	[R_AARCH64_TLSLD_ADR_PREL21] =			"R_AARCH64_TLSLD_ADR_PREL21",
	[R_AARCH64_TLSLD_ADR_PAGE21] =			"R_AARCH64_TLSLD_ADR_PAGE21",
	[R_AARCH64_TLSLD_ADD_LO12_NC] =			"R_AARCH64_TLSLD_ADD_LO12_NC",
	[R_AARCH64_TLLGD_MOVW_G1] =			"R_AARCH64_TLLGD_MOVW_G1",
	[R_AARCH64_TLSLD_MOVW_G0_NC] =			"R_AARCH64_TLSLD_MOVW_G0_NC",
	[R_AARCH64_TLSLD_LD_PREL19] =			"R_AARCH64_TLSLD_LD_PREL19",
	[R_AARCH64_TLSLD_MOVW_DTPREL_G2] =		"R_AARCH64_TLSLD_MOVW_DTPREL_G2",
	[R_AARCH64_TLSLD_MOVW_DTPREL_G1] =		"R_AARCH64_TLSLD_MOVW_DTPREL_G1",
	[R_AARCH64_TLSLD_MOVW_DTPREL_G1_NC] =		"R_AARCH64_TLSLD_MOVW_DTPREL_G1_NC",
	[R_AARCH64_TLSLD_MOVW_DTPREL_G0] =		"R_AARCH64_TLSLD_MOVW_DTPREL_G0",
	[R_AARCH64_TLSLD_MOVW_DTPREL_G0_NC] =		"R_AARCH64_TLSLD_MOVW_DTPREL_G0_NC",
	[R_AARCH64_TLSLD_ADD_DTPREL_HI12] =		"R_AARCH64_TLSLD_ADD_DTPREL_HI12",
	[R_AARCH64_TLSLD_ADD_DTPREL_LO12] =		"R_AARCH64_TLSLD_ADD_DTPREL_LO12",
	[R_AARCH64_TLSLD_ADD_DTPREL_LO12_NC] =		"R_AARCH64_TLSLD_ADD_DTPREL_LO12_NC",
	[R_AARCH64_TLSLD_LDST8_DTPREL_LO12] =		"R_AARCH64_TLSLD_LDST8_DTPREL_LO12",
	[R_AARCH64_TLSLD_LDST8_DTPREL_LO12_NC] =	"R_AARCH64_TLSLD_LDST8_DTPREL_LO12_NC",
	[R_AARCH64_TLSLD_LDST16_DTPREL_LO12] =		"R_AARCH64_TLSLD_LDST16_DTPREL_LO12",
	[R_AARCH64_TLSLD_LDST16_DTPREL_LO12_NC] =	"R_AARCH64_TLSLD_LDST16_DTPREL_LO12_NC",
	[R_AARCH64_TLSLD_LDST32_DTPREL_LO12] =		"R_AARCH64_TLSLD_LDST32_DTPREL_LO12",
	[R_AARCH64_TLSLD_LDST32_DTPREL_LO12_NC] =	"R_AARCH64_TLSLD_LDST32_DTPREL_LO12_NC",
	[R_AARCH64_TLSLD_LDST64_DTPREL_LO12] =		"R_AARCH64_TLSLD_LDST64_DTPREL_LO12",
	[R_AARCH64_TLSLD_LDST64_DTPREL_LO12_NC] =	"R_AARCH64_TLSLD_LDST64_DTPREL_LO12_NC",
	[R_AARCH64_TLSLD_LDST128_DTPREL_LO12] =		"R_AARCH64_TLSLD_LDST128_DTPREL_LO12",
	[R_AARCH64_TLSLD_LDST128_DTPREL_LO12_NC] =	"R_AARCH64_TLSLD_LDST128_DTPREL_LO12_NC",
	[R_AARCH64_TLSIE_MOVW_GOTTPREL_G1] =		"R_AARCH64_TLSIE_MOVW_GOTTPREL_G1",
	[R_AARCH64_TLSIE_MOVW_GOTTPREL_G0_NC] =		"R_AARCH64_TLSIE_MOVW_GOTTPREL_G0_NC",
	[R_AARCH64_TLSIE_ADR_GOTTPREL_PAGE21] =		"R_AARCH64_TLSIE_ADR_GOTTPREL_PAGE21",
	[R_AARCH64_TLSIE_LD64_GOTTPREL_LO12_NC] =	"R_AARCH64_TLSIE_LD64_GOTTPREL_LO12_NC",
	[R_AARCH64_TLSIE_LD_GOTTPREL_PREL19] =		"R_AARCH64_TLSIE_LD_GOTTPREL_PREL19",
	[R_AARCH64_TLSLE_MOVW_TPREL_G2] =		"R_AARCH64_TLSLE_MOVW_TPREL_G2",
	[R_AARCH64_TLSLE_MOVW_TPREL_G1] =		"R_AARCH64_TLSLE_MOVW_TPREL_G1",
	[R_AARCH64_TLSLE_MOVW_TPREL_G1_NC] =		"R_AARCH64_TLSLE_MOVW_TPREL_G1_NC",
	[R_AARCH64_TLSLE_MOVW_TPREL_G0] =		"R_AARCH64_TLSLE_MOVW_TPREL_G0",
	[R_AARCH64_TLSLE_MOVW_TPREL_G0_NC] =		"R_AARCH64_TLSLE_MOVW_TPREL_G0_NC",
	[R_AARCH64_TLSLE_ADD_TPREL_HI12] =		"R_AARCH64_TLSLE_ADD_TPREL_HI12",
	[R_AARCH64_TLSLE_ADD_TPREL_LO12] =		"R_AARCH64_TLSLE_ADD_TPREL_LO12",
	[R_AARCH64_TLSLE_ADD_TPREL_LO12_NC] =		"R_AARCH64_TLSLE_ADD_TPREL_LO12_NC",
	[R_AARCH64_TLSLE_LDST8_TPREL_LO12] =		"R_AARCH64_TLSLE_LDST8_TPREL_LO12",
	[R_AARCH64_TLSLE_LDST8_TPREL_LO12_NC] =		"R_AARCH64_TLSLE_LDST8_TPREL_LO12_NC",
	[R_AARCH64_TLSLE_LDST16_TPREL_LO12] =		"R_AARCH64_TLSLE_LDST16_TPREL_LO12",
	[R_AARCH64_TLSLE_LDST16_TPREL_LO12_NC] =	"R_AARCH64_TLSLE_LDST16_TPREL_LO12_NC",
	[R_AARCH64_TLSLE_LDST32_TPREL_LO12] =		"R_AARCH64_TLSLE_LDST32_TPREL_LO12",
	[R_AARCH64_TLSLE_LDST32_TPREL_LO12_NC] =	"R_AARCH64_TLSLE_LDST32_TPREL_LO12_NC",
	[R_AARCH64_TLSLE_LDST64_TPREL_LO12] =		"R_AARCH64_TLSLE_LDST64_TPREL_LO12",
	[R_AARCH64_TLSLE_LDST64_TPREL_LO12_NC] =	"R_AARCH64_TLSLE_LDST64_TPREL_LO12_NC",
	[R_AARCH64_TLSLE_LDST128_TPREL_LO12] =		"R_AARCH64_TLSLE_LDST128_TPREL_LO12",
	[R_AARCH64_TLSLE_LDST128_TPREL_LO12_NC] =	"R_AARCH64_TLSLE_LDST128_TPREL_LO12_NC",
	[R_AARCH64_TLSDESC_LD_PREL19] =			"R_AARCH64_TLSDESC_LD_PREL19",
	[R_AARCH64_TLSDESC_ADR_PREL21] =		"R_AARCH64_TLSDESC_ADR_PREL21",
	[R_AARCH64_TLSDESC_ADR_PAGE21] =		"R_AARCH64_TLSDESC_ADR_PAGE21",
	[R_AARCH64_TLSDESC_LD64_LO12] =			"R_AARCH64_TLSDESC_LD64_LO12",
	[R_AARCH64_TLSDESC_ADD_LO12] =			"R_AARCH64_TLSDESC_ADD_LO12",
	[R_AARCH64_TLSDESC_OFF_G1] =			"R_AARCH64_TLSDESC_OFF_G1",
	[R_AARCH64_TLSDESC_OFF_G0_NC] =			"R_AARCH64_TLSDESC_OFF_G0_NC",
	[R_AARCH64_TLSDESC_LDR] =			"R_AARCH64_TLSDESC_LDR",
	[R_AARCH64_TLSDESC_ADD] =			"R_AARCH64_TLSDESC_ADD",
	[R_AARCH64_TLSDESC_CALL] =			"R_AARCH64_TLSDESC_CALL",
	[R_AARCH64_COPY] =				"R_AARCH64_COPY",
	[R_AARCH64_GLOB_DAT] =				"R_AARCH64_GLOB_DAT",
	[R_AARCH64_JUMP_SLOT] =				"R_AARCH64_JUMP_SLOT",
	[R_AARCH64_RELATIVE] =				"R_AARCH64_RELATIVE",
	[R_AARCH64_TLS_DTPREL64] =			"R_AARCH64_TLS_DTPREL64",
	[R_AARCH64_TLS_DTPMOD64] =			"R_AARCH64_TLS_DTPMOD64",
	[R_AARCH64_TLS_TPREL64] =			"R_AARCH64_TLS_TPREL64",
	[R_AARCH64_TLSDESC] =				"R_AARCH64_TLSDESC",
	[R_AARCH64_TLS_IRELATIVE] =			"R_AARCH64_TLS_IRELATIVE",
};

#if (R_AARCH64_NUM != 1033)
#error "R_AARCH64_NUM has grown"
#endif

const char *
conv_reloc_AARCH64_type(Word type)
{
	static char 	strbuf[32];
	int		ndx = 31;

	if (type < R_AARCH64_NUM)
		return (rels[type]);

	strbuf[ndx--] = '\0';
	do {
		strbuf[ndx--] = '0' + (type % 10);
		type = type / 10;
	} while ((ndx >= (int)0) && (type > (Word)0));

	return (&strbuf[ndx + 1]);
}
